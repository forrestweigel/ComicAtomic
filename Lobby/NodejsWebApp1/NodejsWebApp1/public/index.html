<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap - Prebuilt Layout</title>
    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <link href="bootstrap-4.4.1.css" rel="stylesheet">

</head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
       <a class="navbar-brand" href="#">Navbar</a>
       <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
       <span class="navbar-toggler-icon"></span>
       </button>
       <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
             <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
             </li>
             <li class="nav-item">
                <a class="nav-link" href="#">Link</a>
             </li>
             <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Dropdown
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                   <a class="dropdown-item" href="#">Action</a>
                   <a class="dropdown-item" href="#">Another action</a>
                   <div class="dropdown-divider"></div>
                   <a class="dropdown-item" href="#">Something else here</a>
                </div>
             </li>
             <li class="nav-item">
                <a class="nav-link disabled" href="#">Disabled</a>
             </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
             <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
             <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
          </form>
       </div>
    </nav>

    <div class="jumbotron"> </div>
    
       <br>
       <hr>
       <br>
       
       <div class ="row">
          <div class="col-md-6 text-center col-xl-4">
             <div class="card">
                <div class="card-body">
                   <h3>&nbsp;</h3>
                  
                   <p><button type="button" class="btn btn-success btn-md" id="create" onclick="">Create Game</button></p>
                   <button type="button" class="btn btn-success btn-md" id="join">&nbsp&nbsp Join Game&nbsp</button>
                </div>
             </div>
          </div>
		   
		   <div class="col-md-6 text-center col-xl-4">
             <div class="card">
				  <h3>Active Users&nbsp;</h3>
                <div class="card-body" id="users">
                   
                    
               </div>
             </div>
          </div>
		   
		   <div class="col-md-6 text-center col-xl-4">
             <div class="card">
				 <h3>Games&nbsp;</h3>
                <div class="card-body" id = "games">
                    <select class="form-select" aria-label="Default select example" id="gamelist">
                        
                    </select>
                </div>
				  
             </div>
          </div>
		   
		   
		   
		   
      </div>
      
       <br>
       <hr>
       <div class="row">
          <div class="text-center col-lg-6 offset-lg-3">
             <h4>Footer </h4>
             <p>Copyright &copy; 2020 &middot; All Rights Reserved &middot; <a href="#" >My Website</a></p>
          </div>
       </div>


      <script>

          //function games = (id,creator) => {

          //    this.id = id;
          //    this.creator = creator;

          //};

        

          document.getElementById("create").addEventListener("click", function () {
               //document.getElementById("users").innerHTML += "LOLOLOL"
                
                socket.emit("create");
          });

           document.getElementById("join").addEventListener("click", function () {
               //document.getElementById("users").innerHTML += "LOLOLOL"

               //var item = document.querySelector('#gamelist option:selected');
               var sel = document.getElementById('gamelist').value;
                socket.emit("join",sel);
           });

          var socket = io();

          const inboxPeople = document.querySelector(".inbox__people");

        let userName = "";



        const newUserConnected = (user) => {
            userName = user || `User${Math.floor(Math.random() * 1000000)}`;
            socket.emit("new user", userName);
            addToUsersBox(userName);
        };

        const sendMessage = () => {

              socket.emit('m', "worked")
        }

        const addToUsersBox = (userName) => {
            if (!!document.querySelector(`.${userName}-userlist`)) {
                return;
            }

            const userBox = `
            <div class="chat_ib ${userName}-userlist">
              <h5>${userName}</h5>
            </div>
          `;

            
            document.getElementById("users").innerHTML += userBox;
        };

            // new user is created so we generate nickname and emit event
            newUserConnected();

            socket.on("new user", function (data) {
                data.map((user) => addToUsersBox(user));
            });

            socket.on("user disconnected", function (userName) {
                document.querySelector(`.${userName}-userlist`).remove();
            });

        

          socket.on("create", function (data) {

              var li = document.createElement('option');
              
              var list = document.getElementById("gamelist");

              li.setAttribute('value', data);
              li.setAttribute('id', data);
              li.appendChild(document.createTextNode(data + "'s game"));
              list.appendChild(li);

              
             
          });

          socket.on("join", function(data,data2) {

              //data = user joining game data2 = game creator
              document.getElementById("users").innerHTML += data;
              document.getElementById("users").innerHTML += data2;

              var item = document.getElementById(data2);
              var remove = document.getElementById("gamelist");
              remove.removeChild(item);

              
             
          });



      </script>
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) --> 
    <script src="jquery-3.4.1.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed --> 
    <script src="jspopper.min.js"></script>
    <script src="bootstrap-4.4.1.js"></script>
  </body>
</html>
